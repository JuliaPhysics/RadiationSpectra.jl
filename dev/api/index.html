<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · RadiationSpectra.jl</title><link rel="canonical" href="https://JuliaPhysics.github.io/RadiationSpectra.jl/stable/api/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>RadiationSpectra.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/spectrum_deconvolution/">Peak Finding</a></li><li><a class="toctext" href="../man/fitting/">Fitting</a></li><li><a class="toctext" href="../man/spectrum_calibration/">Calibration</a></li></ul></li><li class="current"><a class="toctext" href>API</a><ul class="internal"><li><a class="toctext" href="#Types-1">Types</a></li><li><a class="toctext" href="#Functions-1">Functions</a></li><li class="toplevel"><a class="toctext" href="#Documentation-1">Documentation</a></li></ul></li><li><a class="toctext" href="../LICENSE/">LICENSE</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>API</a></li></ul><a class="edit-page" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/master/docs/src/api.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>API</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="API-1" href="#API-1">API</a></h1><h2><a class="nav-anchor" id="Types-1" href="#Types-1">Types</a></h2><ul><li><a href="#RadiationSpectra.AbstractFitFunction"><code>RadiationSpectra.AbstractFitFunction</code></a></li><li><a href="#RadiationSpectra.FitFunction"><code>RadiationSpectra.FitFunction</code></a></li></ul><h2><a class="nav-anchor" id="Functions-1" href="#Functions-1">Functions</a></h2><ul><li><a href="#RadiationSpectra.calibrate_spectrum-Union{Tuple{E}, Tuple{T}, Tuple{Histogram{#s117,1,E} where #s117&lt;:Real,Array{#s116,1} where #s116&lt;:Real}} where E where T"><code>RadiationSpectra.calibrate_spectrum</code></a></li><li><a href="#RadiationSpectra.get_example_spectrum-Tuple{}"><code>RadiationSpectra.get_example_spectrum</code></a></li><li><a href="#RadiationSpectra.llhfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.llhfit!</code></a></li><li><a href="#RadiationSpectra.lsqfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.lsqfit!</code></a></li><li><a href="#RadiationSpectra.peakfinder-Tuple{StatsBase.Histogram}"><code>RadiationSpectra.peakfinder</code></a></li></ul><h1><a class="nav-anchor" id="Documentation-1" href="#Documentation-1">Documentation</a></h1><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.FitFunction" href="#RadiationSpectra.FitFunction"><code>RadiationSpectra.FitFunction</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">struct FitFunction{T, ND, NP} &lt;: AbstractFitFunction{T, ND, NP}</code></pre><p>T: Precision type</p><p>ND: Dimensionality</p><p>NP: NP parameters</p><p>Fields:</p><ul><li><code>model::Function</code>: Function of the fit model.</li><li><code>fitranges::NTuple{N, Vector{T}}</code>: Range on which the fit is performed.</li><li><code>parameter_names::Vector{Symbol}</code>: Parameters names.</li><li><code>fitted_parameters::Vector{T}</code>: Fitted parameters.</li><li><code>initial_parameters::Vector{T}</code>: Initial parameters.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/47cd6cafa0edfe813a057f981df32b69d73111bb/src/Fitting/FitFunction.jl#L8-L24">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.calibrate_spectrum-Union{Tuple{E}, Tuple{T}, Tuple{Histogram{#s117,1,E} where #s117&lt;:Real,Array{#s116,1} where #s116&lt;:Real}} where E where T" href="#RadiationSpectra.calibrate_spectrum-Union{Tuple{E}, Tuple{T}, Tuple{Histogram{#s117,1,E} where #s117&lt;:Real,Array{#s116,1} where #s116&lt;:Real}} where E where T"><code>RadiationSpectra.calibrate_spectrum</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">calibrate_spectrum(h_uncal::Histogram, photon_lines::Array{Real, 1}; &lt;keyword arguments&gt;)</code></pre><p>Returns the calibrated histogram, the deconvoluted spectrum, the found (uncalibrated) peak positions and the final <code>threshold</code> value.</p><p><strong>Keywords</strong></p><ul><li><code>σ::Real = 2.0</code>: The expected sigma of a peak in the spectrum. In units of bins. </li><li><code>threshold::Real = 10.0</code>: Threshold for being identified as a peak in the deconvoluted spectrum. A single bin is identified as a peak when its weight exceeds the <code>threshold</code> and the previous bin was not identified as an peak.</li><li><code>min_n_peaks::Int = 0</code>: If the number of found peaks is smaller than <code>min_n_peaks</code> the functions lowers the parameter <code>threshold</code> until enough peaks are found.</li><li><code>max_n_peaks::Int = 50</code>: Use only the first (strongest) <code>max_n_peaks</code> peaks for peak identification.</li><li><code>α::Real = 0.005</code>:  = 0.5%. Acceptance level in the comparison of the peak position ratios in the peak indentification step. When the difference between the ratio of two found peak positions and the ratio of two photon lines (<code>photon_lines</code>) is smaller than <code>α</code>, the found peaks are identified as the two photon lines.</li><li><code>rtol::Real = 5e-3</code>:  = 5e-3. Acceptance level for tolerance of the absolute difference between true and found line position.</li></ul><p>Calibrate the spectrum <code>h_uncal</code>. This is done by:</p><ol><li>finding peaks through devoncolution</li><li>identifying them through comparison of the ratios of their positions with the ratios of the known <code>lines</code></li><li>fitting all identified peaks (with a gaussian plus first order polynomial) to get their position more precisely</li><li>performe a linear fit (offset forced to 0) of these positions vs the true positions (<code>lines</code>) to get the calibration constant </li></ol></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/47cd6cafa0edfe813a057f981df32b69d73111bb/src/AutoCalibration/AutoCalibration.jl#L145-L163">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.llhfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},Histogram}} where NP where T&lt;:AbstractFloat" href="#RadiationSpectra.llhfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.llhfit!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">llhfit!(fit::FitFunction{T, 1, NP}, h::Histogram)::Nothing where {T &lt;: AbstractFloat, NP}</code></pre><p>Performs a log-likelihood fit of the model function <code>fit.model</code> and the initial parameters <code>fit.initial_parameters</code> on the histogram <code>h</code> in the range <code>fit.fitranges[1]</code>. The determined parameters are stored in <code>fit.fitted_parameters</code>.</p><p>The likelihood for each individual bin is the Poission distribution.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/47cd6cafa0edfe813a057f981df32b69d73111bb/src/Fitting/llhfit.jl#L22-L29">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.lsqfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},Histogram}} where NP where T&lt;:AbstractFloat" href="#RadiationSpectra.lsqfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.lsqfit!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">lsqfit!(fit::FitFunction{T, 1, NP}, h::Histogram)::Nothing where {T &lt;: AbstractFloat, NP}</code></pre><p>Performs a least square fit with the model <code>fit.model</code> and the initial parameters <code>fit.initial_parameters</code> on the histogram <code>h</code> in the range <code>fit.fitranges[1]</code>. The determined parameters are stored in <code>fit.fitted_parameters</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/47cd6cafa0edfe813a057f981df32b69d73111bb/src/Fitting/lsqfit.jl#L34-L39">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.peakfinder-Tuple{StatsBase.Histogram}" href="#RadiationSpectra.peakfinder-Tuple{StatsBase.Histogram}"><code>RadiationSpectra.peakfinder</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">peakfinder(h::Histogram; &lt;keyword arguments&gt;)::Tuple{Histogram, Array{Float64, 1}}</code></pre><p>Returns a deconvoluted spectrum and an array of peak positions.</p><p><strong>Keywords</strong></p><ul><li><code>σ::Real=2.0</code>: The expected sigma of a peak in the spectrum. In units of bins. </li><li><code>threshold::Real=10.0</code>: Threshold for being identified as a peak in the deconvoluted spectrum. A single bin is identified as a peak when its weight exceeds the <code>threshold</code> and the previous bin was not identified as an peak.</li><li><code>backgroundRemove::Bool=true</code></li><li><code>deconIterations::Int=3</code></li><li><code>markov::Bool=true</code></li><li><code>averWindow::Int=3</code></li></ul><p><strong>Source</strong></p><p>This function is basically a copy of <code>TSpectrum::SearchHighRes</code> from <a href="https://root.cern.ch/doc/master/classTSpectrum.html">ROOT</a>.</p><ul><li>M.A. Mariscotti: A method for identification of peaks in the presence of background and its application to spectrum analysis. NIM 50 (1967), 309-320.</li><li>M. Morhac;, J. Kliman, V. Matouoek, M. Veselsky, I. Turzo.:Identification of peaks in multidimensional coincidence gamma-ray spectra. NIM, A443 (2000) 108-125.</li><li>Z.K. Silagadze, A new algorithm for automatic photopeak searches. NIM A 376 (1996), 451.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/47cd6cafa0edfe813a057f981df32b69d73111bb/src/PeakFinder/PeakFinder.jl#L371-L390">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.AbstractFitFunction" href="#RadiationSpectra.AbstractFitFunction"><code>RadiationSpectra.AbstractFitFunction</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">AbstractFitFunction{T, ND, NP}</code></pre><p>Abstract type for an <code>ND</code>-dimensional fit of eltype <code>T</code> with <code>NP</code> parameters.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/47cd6cafa0edfe813a057f981df32b69d73111bb/src/Fitting/FitFunction.jl#L1-L5">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.get_example_spectrum-Tuple{}" href="#RadiationSpectra.get_example_spectrum-Tuple{}"><code>RadiationSpectra.get_example_spectrum</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">get_example_spectrum()::Histogram</code></pre><p>Returns an uncalibrated radiation spectrum for testing and demonstrating purpose.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/47cd6cafa0edfe813a057f981df32b69d73111bb/src/RadiationSpectra.jl#L31-L35">source</a></section><footer><hr/><a class="previous" href="../man/spectrum_calibration/"><span class="direction">Previous</span><span class="title">Calibration</span></a><a class="next" href="../LICENSE/"><span class="direction">Next</span><span class="title">LICENSE</span></a></footer></article></body></html>
