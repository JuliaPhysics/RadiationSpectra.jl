<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · RadiationSpectra.jl</title><link rel="canonical" href="https://JuliaPhysics.github.io/RadiationSpectra.jl/stable/api/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">RadiationSpectra.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/spectrum_deconvolution/">Peak Finding</a></li><li><a class="tocitem" href="../man/fitting/">Fitting</a></li><li><a class="tocitem" href="../man/spectrum_calibration/">Calibration</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Types-1"><span>Types</span></a></li><li><a class="tocitem" href="#Functions-1"><span>Functions</span></a></li><li class="toplevel"><a class="tocitem" href="#Documentation-1"><span>Documentation</span></a></li></ul></li><li><a class="tocitem" href="../LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API-1"><a class="docs-heading-anchor" href="#API-1">API</a><a class="docs-heading-anchor-permalink" href="#API-1" title="Permalink"></a></h1><h2 id="Types-1"><a class="docs-heading-anchor" href="#Types-1">Types</a><a class="docs-heading-anchor-permalink" href="#Types-1" title="Permalink"></a></h2><ul><li><a href="#RadiationSpectra.AbstractFitFunction"><code>RadiationSpectra.AbstractFitFunction</code></a></li><li><a href="#RadiationSpectra.FitFunction"><code>RadiationSpectra.FitFunction</code></a></li></ul><h2 id="Functions-1"><a class="docs-heading-anchor" href="#Functions-1">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-1" title="Permalink"></a></h2><ul><li><a href="#RadiationSpectra.calibrate_spectrum-Union{Tuple{E}, Tuple{T}, Tuple{StatsBase.Histogram{#s117,1,E} where #s117&lt;:Real,Array{#s116,1} where #s116&lt;:Real}} where E where T"><code>RadiationSpectra.calibrate_spectrum</code></a></li><li><a href="#RadiationSpectra.fit_single_peak_histogram-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram,Union{Missing, Tuple{T,T}}}} where T&lt;:Real"><code>RadiationSpectra.fit_single_peak_histogram</code></a></li><li><a href="#RadiationSpectra.fit_single_peak_histogram_refined-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram,Union{Missing, Tuple{T,T}}}} where T&lt;:Real"><code>RadiationSpectra.fit_single_peak_histogram_refined</code></a></li><li><a href="#RadiationSpectra.get_example_spectrum-Tuple{}"><code>RadiationSpectra.get_example_spectrum</code></a></li><li><a href="#RadiationSpectra.llhfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},StatsBase.Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.llhfit!</code></a></li><li><a href="#RadiationSpectra.lsqfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},StatsBase.Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.lsqfit!</code></a></li><li><a href="#RadiationSpectra.peakfinder-Tuple{StatsBase.Histogram}"><code>RadiationSpectra.peakfinder</code></a></li></ul><h1 id="Documentation-1"><a class="docs-heading-anchor" href="#Documentation-1">Documentation</a><a class="docs-heading-anchor-permalink" href="#Documentation-1" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.FitFunction" href="#RadiationSpectra.FitFunction"><code>RadiationSpectra.FitFunction</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">mutable struct FitFunction{T, ND, NP} &lt;: AbstractFitFunction{T, ND, NP}</code></pre><p>T: Precision type</p><p>ND: Dimensionality</p><p>NP: NP parameters</p><p>Fields:</p><ul><li><code>model::Function</code>: Function of the fit model.</li><li><code>fitranges::NTuple{N, Vector{T}}</code>: Range on which the fit is performed.</li><li><code>parameter_names::Vector{Symbol}</code>: Parameters names.</li><li><code>fitted_parameters::Vector{T}</code>: Fitted parameters.</li><li><code>initial_parameters::Vector{T}</code>: Initial parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/Fitting/FitFunction.jl#L8-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.calibrate_spectrum-Union{Tuple{E}, Tuple{T}, Tuple{StatsBase.Histogram{#s117,1,E} where #s117&lt;:Real,Array{#s116,1} where #s116&lt;:Real}} where E where T" href="#RadiationSpectra.calibrate_spectrum-Union{Tuple{E}, Tuple{T}, Tuple{StatsBase.Histogram{#s117,1,E} where #s117&lt;:Real,Array{#s116,1} where #s116&lt;:Real}} where E where T"><code>RadiationSpectra.calibrate_spectrum</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">calibrate_spectrum(h_uncal::Histogram, photon_lines::Array{Real, 1}; &lt;keyword arguments&gt;)</code></pre><p>Returns the calibrated histogram, the deconvoluted spectrum, the found (uncalibrated) peak positions and the final <code>threshold</code> value.</p><p><strong>Keywords</strong></p><ul><li><code>σ::Real = 2.0</code>: The expected sigma of a peak in the spectrum. In units of bins.</li><li><code>threshold::Real = 10.0</code>: Threshold for being identified as a peak in the deconvoluted spectrum. A single bin is identified as a peak when its weight exceeds the <code>threshold</code> and the previous bin was not identified as an peak.</li><li><code>min_n_peaks::Int = 0</code>: If the number of found peaks is smaller than <code>min_n_peaks</code> the functions lowers the parameter <code>threshold</code> until enough peaks are found.</li><li><code>max_n_peaks::Int = 50</code>: Use only the first (strongest) <code>max_n_peaks</code> peaks for peak identification.</li><li><code>α::Real = 0.005</code>:  = 0.5%. Acceptance level in the comparison of the peak position ratios in the peak indentification step. When the difference between the ratio of two found peak positions and the ratio of two photon lines (<code>photon_lines</code>) is smaller than <code>α</code>, the found peaks are identified as the two photon lines.</li><li><code>rtol::Real = 5e-3</code>:  = 5e-3. Acceptance level for tolerance of the absolute difference between true and found line position.</li></ul><p>Calibrate the spectrum <code>h_uncal</code>. This is done by:</p><ol><li>finding peaks through devoncolution</li><li>identifying them through comparison of the ratios of their positions with the ratios of the known <code>lines</code></li><li>fitting all identified peaks (with a gaussian plus first order polynomial) to get their position more precisely</li><li>performe a linear fit (offset forced to 0) of these positions vs the true positions (<code>lines</code>) to get the calibration constant</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/AutoCalibration/AutoCalibration.jl#L150-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.fit_single_peak_histogram-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram,Union{Missing, Tuple{T,T}}}} where T&lt;:Real" href="#RadiationSpectra.fit_single_peak_histogram-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram,Union{Missing, Tuple{T,T}}}} where T&lt;:Real"><code>RadiationSpectra.fit_single_peak_histogram</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">fit_single_peak_histogram(h::StatsBase.Histogram, fitrange::Union{Tuple{T,T}, Missing} = missing; fit_function = :Gauss, weights = missing )::FitFunction{T, 1, NP} where {T &lt;: AbstractFloat, NP}</code></pre><p>This method is meant for quick and stable fitting. The estimation of initial parameters is done automatically, this allows and easy fit with just one line of code. The user is expected to pass a histogram containing only one peak or specify corresponding fitrange. The method performs a least square fit with the model specified under  <code>fit_function = ...</code>. Currently supported are :Gauss (default), :Gauss_pol1, Cauchy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/Fitting/predefined_fit_routines.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.fit_single_peak_histogram_refined-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram,Union{Missing, Tuple{T,T}}}} where T&lt;:Real" href="#RadiationSpectra.fit_single_peak_histogram_refined-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram,Union{Missing, Tuple{T,T}}}} where T&lt;:Real"><code>RadiationSpectra.fit_single_peak_histogram_refined</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">fit_single_peak_histogram_refined(h::StatsBase.Histogram, fitrange::Union{Tuple{T,T}, Missing} = missing; n_sig = 3.0, fit_function = :Gauss, weights = missing )::FitFunction{T, 1, NP} where {T &lt;: AbstractFloat, NP}</code></pre><p>This method is meant for quick and stable fitting. The estimation of initial parameters is done automatically, this allows and easy fit with just one line of code. The user is expected to pass a histogram containing only one peak or specify corresponding fitrange. The method performs a least square fit with the model specified under  <code>fit_function = ...</code>. Currently supported are :Gauss (default), :Gauss<em>pol1, Cauchy. It then fits again using the results of the first fit as initial parameters. The fitrange for the second fit can be customized using the `n</em>sig = ...` keyword.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/Fitting/predefined_fit_routines.jl#L40-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.llhfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},StatsBase.Histogram}} where NP where T&lt;:AbstractFloat" href="#RadiationSpectra.llhfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},StatsBase.Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.llhfit!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">llhfit!(fit::FitFunction{T, 1, NP}, h::Histogram)::Nothing where {T &lt;: AbstractFloat, NP}</code></pre><p>Performs a log-likelihood fit of the model function <code>fit.model</code> and the initial parameters <code>fit.initial_parameters</code> on the histogram <code>h</code> in the range <code>fit.fitranges[1]</code>. The determined parameters are stored in <code>fit.fitted_parameters</code>.</p><p>The likelihood for each individual bin is the Poission distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/Fitting/llhfit.jl#L42-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.lsqfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},StatsBase.Histogram}} where NP where T&lt;:AbstractFloat" href="#RadiationSpectra.lsqfit!-Union{Tuple{NP}, Tuple{T}, Tuple{FitFunction{T,1,NP},StatsBase.Histogram}} where NP where T&lt;:AbstractFloat"><code>RadiationSpectra.lsqfit!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">lsqfit!(fit::FitFunction{T, 1, NP}, h::Histogram)::Nothing where {T &lt;: AbstractFloat, NP}</code></pre><p>Performs a least square fit with the model <code>fit.model</code> and the initial parameters <code>fit.initial_parameters</code> on the histogram <code>h</code> in the range <code>fit.fitranges[1]</code>. The determined parameters are stored in <code>fit.fitted_parameters</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/Fitting/lsqfit.jl#L23-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.peakfinder-Tuple{StatsBase.Histogram}" href="#RadiationSpectra.peakfinder-Tuple{StatsBase.Histogram}"><code>RadiationSpectra.peakfinder</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">peakfinder(h::Histogram; &lt;keyword arguments&gt;)::Tuple{Histogram, Array{Float64, 1}}</code></pre><p>Returns a deconvoluted spectrum and an array of peak positions.</p><p><strong>Keywords</strong></p><ul><li><code>σ::Real=2.0</code>: The expected sigma of a peak in the spectrum. In units of bins. </li><li><code>threshold::Real=10.0</code>: Threshold for being identified as a peak in the deconvoluted spectrum. A single bin is identified as a peak when its weight exceeds the <code>threshold</code> and the previous bin was not identified as an peak.</li><li><code>backgroundRemove::Bool=true</code></li><li><code>deconIterations::Int=3</code></li><li><code>markov::Bool=true</code></li><li><code>averWindow::Int=3</code></li></ul><p><strong>Source</strong></p><p>This function is basically a copy of <code>TSpectrum::SearchHighRes</code> from <a href="https://root.cern.ch/doc/master/classTSpectrum.html">ROOT</a>.</p><ul><li>M.A. Mariscotti: A method for identification of peaks in the presence of background and its application to spectrum analysis. NIM 50 (1967), 309-320.</li><li>M. Morhac;, J. Kliman, V. Matouoek, M. Veselsky, I. Turzo.:Identification of peaks in multidimensional coincidence gamma-ray spectra. NIM, A443 (2000) 108-125.</li><li>Z.K. Silagadze, A new algorithm for automatic photopeak searches. NIM A 376 (1996), 451.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/PeakFinder/PeakFinder.jl#L371-L390">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.AbstractFitFunction" href="#RadiationSpectra.AbstractFitFunction"><code>RadiationSpectra.AbstractFitFunction</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractFitFunction{T, ND, NP}</code></pre><p>Abstract type for an <code>ND</code>-dimensional fit of eltype <code>T</code> with <code>NP</code> parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/Fitting/FitFunction.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RadiationSpectra.get_example_spectrum-Tuple{}" href="#RadiationSpectra.get_example_spectrum-Tuple{}"><code>RadiationSpectra.get_example_spectrum</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">get_example_spectrum()::Histogram</code></pre><p>Returns an uncalibrated radiation spectrum for testing and demonstrating purpose.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaPhysics/RadiationSpectra.jl/blob/336bd65ce0717960bd6bf70e06711c4d3b360eb1/src/RadiationSpectra.jl#L53-L57">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../man/spectrum_calibration/">« Calibration</a><a class="docs-footer-nextpage" href="../LICENSE/">LICENSE »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 April 2020 00:28">Wednesday 15 April 2020</span>. Using Julia version 1.4.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
